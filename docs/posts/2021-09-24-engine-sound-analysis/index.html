<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>エンジン音のスペクトログラム | BlankSpace</title><meta name=keywords content="MATLAB/Simulink,Motorcycle"><meta name=description content="マイク  Google Pixel 4a  解析対象  バイク  125cc 単気筒 4ストローク NA   F1  2.4L V8 4ストローク NA   ブルーインパルス  ターボファン・エンジン    バイク  1100rpm     5000rpm     Revving    F1  ブルーインパルス  使用環境  MATLAB R2020a Signal Processing Toolbox  参考  MathWorks - オーディオとビデオ MathWorks - spectrogram Wikipedia - 短時間フーリエ変換 MATLABによる音声信号処理入門  ソースコード clear all; close all; clc; % ファイル名 filename = 'filename'; % オーディオファイルに関する情報取得 info = audioinfo(filename) % オーディオファイル読み込み（5秒分だけ） samples = [1,5*info."><meta name=author content><link rel=canonical href=https://xxkizashi.github.io/blank-space/posts/2021-09-24-engine-sound-analysis/><meta name=google-site-verification content="G-N5SK15KKS3"><link crossorigin=anonymous href=/blank-space/assets/css/stylesheet.min.e21185e6c4b43ff34c81666f70aa4f80140274057866888c0a5c28addc9b7fd2.css integrity="sha256-4hGF5sS0P/NMgWZvcKpPgBQCdAV4ZoiMClwordybf9I=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/blank-space/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w=" onload=hljs.initHighlightingOnLoad();></script><link rel=icon href=https://xxkizashi.github.io/blank-space/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://xxkizashi.github.io/blank-space/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://xxkizashi.github.io/blank-space/favicon-32x32.png><link rel=apple-touch-icon href=https://xxkizashi.github.io/blank-space/apple-touch-icon.png><link rel=mask-icon href=https://xxkizashi.github.io/blank-space/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme: rgb(29, 30, 32);--entry: rgb(46, 46, 51);--primary: rgb(218, 218, 219);--secondary: rgb(155, 156, 157);--tertiary: rgb(65, 66, 68);--content: rgb(196, 196, 197);--hljs-bg: rgb(46, 46, 51);--code-bg: rgb(55, 56, 62);--border: rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create','G-N5SK15KKS3','auto');ga('send','pageview');}</script><meta property="og:title" content="エンジン音のスペクトログラム"><meta property="og:description" content="マイク  Google Pixel 4a  解析対象  バイク  125cc 単気筒 4ストローク NA   F1  2.4L V8 4ストローク NA   ブルーインパルス  ターボファン・エンジン    バイク  1100rpm     5000rpm     Revving    F1  ブルーインパルス  使用環境  MATLAB R2020a Signal Processing Toolbox  参考  MathWorks - オーディオとビデオ MathWorks - spectrogram Wikipedia - 短時間フーリエ変換 MATLABによる音声信号処理入門  ソースコード clear all; close all; clc; % ファイル名 filename = 'filename'; % オーディオファイルに関する情報取得 info = audioinfo(filename) % オーディオファイル読み込み（5秒分だけ） samples = [1,5*info."><meta property="og:type" content="article"><meta property="og:url" content="https://xxkizashi.github.io/blank-space/posts/2021-09-24-engine-sound-analysis/"><meta property="og:image" content="https://xxkizashi.github.io/blank-space/eyecatch.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-09-24T00:00:00+00:00"><meta property="article:modified_time" content="2021-09-24T00:00:00+00:00"><meta property="og:site_name" content="BlankSpace"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://xxkizashi.github.io/blank-space/eyecatch.jpg"><meta name=twitter:title content="エンジン音のスペクトログラム"><meta name=twitter:description content="マイク  Google Pixel 4a  解析対象  バイク  125cc 単気筒 4ストローク NA   F1  2.4L V8 4ストローク NA   ブルーインパルス  ターボファン・エンジン    バイク  1100rpm     5000rpm     Revving    F1  ブルーインパルス  使用環境  MATLAB R2020a Signal Processing Toolbox  参考  MathWorks - オーディオとビデオ MathWorks - spectrogram Wikipedia - 短時間フーリエ変換 MATLABによる音声信号処理入門  ソースコード clear all; close all; clc; % ファイル名 filename = 'filename'; % オーディオファイルに関する情報取得 info = audioinfo(filename) % オーディオファイル読み込み（5秒分だけ） samples = [1,5*info."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://xxkizashi.github.io/blank-space/posts/"},{"@type":"ListItem","position":2,"name":"エンジン音のスペクトログラム","item":"https://xxkizashi.github.io/blank-space/posts/2021-09-24-engine-sound-analysis/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"エンジン音のスペクトログラム","name":"エンジン音のスペクトログラム","description":"マイク  Google Pixel 4a  解析対象  バイク  125cc 単気筒 4ストローク NA   F1  2.4L V8 4ストローク NA   ブルーインパルス  ターボファン・エンジン    バイク  1100rpm     5000rpm     Revving    F1  ブルーインパルス  使用環境  MATLAB R2020a Signal Processing Toolbox  参考  MathWorks - オーディオとビデオ MathWorks - spectrogram Wikipedia - 短時間フーリエ変換 MATLABによる音声信号処理入門  ソースコード clear all; close all; clc; % ファイル名 filename = \u0026#39;filename\u0026#39;; % オーディオファイルに関する情報取得 info = audioinfo(filename) % オーディオファイル読み込み（5秒分だけ） samples = [1,5*info.","keywords":["MATLAB/Simulink","Motorcycle"],"articleBody":"マイク  Google Pixel 4a  解析対象  バイク  125cc 単気筒 4ストローク NA   F1  2.4L V8 4ストローク NA   ブルーインパルス  ターボファン・エンジン    バイク  1100rpm     5000rpm     Revving    F1  ブルーインパルス  使用環境  MATLAB R2020a Signal Processing Toolbox  参考  MathWorks - オーディオとビデオ MathWorks - spectrogram Wikipedia - 短時間フーリエ変換 MATLABによる音声信号処理入門  ソースコード clear all; close all; clc; % ファイル名 filename = 'filename'; % オーディオファイルに関する情報取得 info = audioinfo(filename) % オーディオファイル読み込み（5秒分だけ） samples = [1,5*info.SampleRate]; [y,Fs] = audioread(filename,samples,'double'); % ステレオ→モノラル if size(y,2) yMono = sum(y,2) / size(y,2); y = yMono; end % 振幅グラフ subplot(2,1,1); plot(0:1/Fs:(length(y)-1)/Fs,y); xlabel('Time (seconds)'); ylabel('Amplitude'); ylim([-1.5 1.5]); % スペクトログラム Nw = 4096; % フレーム長 No = 1024; % フレームシフト長（オーバーラップ1/4） subplot(2,1,2); spectrogram(y,Nw,No,Nw,Fs,'yaxis'); ax = gca; ax.YScale = 'log'; % 対数表示 xlabel('Time (seconds)'); ylabel('Frequency (kHz)'); % カラーバー位置変更 colorbar('off'); c = colorbar('east'); c.Label.String = 'Power/frequency (dB/Hz)'; % サブプロットのタイトル sgt = sgtitle(filename,'Color','red'); sgt.FontSize = 16; % グラフを保存 [filepath,name,ext] = fileparts(filename); saveas(gcf,strcat(name,'.png')); % オーディオファイル再生 playerObj = audioplayer(y,Fs); play(playerObj); ","wordCount":"142","inLanguage":"en","datePublished":"2021-09-24T00:00:00Z","dateModified":"2021-09-24T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://xxkizashi.github.io/blank-space/posts/2021-09-24-engine-sound-analysis/"},"publisher":{"@type":"Organization","name":"BlankSpace","logo":{"@type":"ImageObject","url":"https://xxkizashi.github.io/blank-space/favicon.ico"}}}</script></head><body id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><header class=header><nav class=nav><div class=logo><a href=https://xxkizashi.github.io/blank-space/ accesskey=h title="BlankSpace (Alt + H)">BlankSpace</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://xxkizashi.github.io/blank-space/about/ title=About><span>About</span></a></li><li><a href=https://xxkizashi.github.io/blank-space/archives title=Archive><span>Archive</span></a></li><li><a href=https://xxkizashi.github.io/blank-space/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://xxkizashi.github.io/blank-space/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://xxkizashi.github.io/FSAE_TO_WIN/ title="FSAE Links"><span>FSAE Links</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://xxkizashi.github.io/blank-space/>Home</a>&nbsp;»&nbsp;<a href=https://xxkizashi.github.io/blank-space/posts/>Posts</a></div><h1 class=post-title>エンジン音のスペクトログラム</h1><div class=post-meta><span title="2021-09-24 00:00:00 +0000 UTC">September 24, 2021</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e3%83%9e%e3%82%a4%e3%82%af aria-label=マイク>マイク</a></li><li><a href=#%e8%a7%a3%e6%9e%90%e5%af%be%e8%b1%a1 aria-label=解析対象>解析対象</a></li><li><a href=#%e3%83%90%e3%82%a4%e3%82%af aria-label=バイク>バイク</a></li><li><a href=#f1 aria-label=F1>F1</a></li><li><a href=#%e3%83%96%e3%83%ab%e3%83%bc%e3%82%a4%e3%83%b3%e3%83%91%e3%83%ab%e3%82%b9 aria-label=ブルーインパルス>ブルーインパルス</a></li><li><a href=#%e4%bd%bf%e7%94%a8%e7%92%b0%e5%a2%83 aria-label=使用環境>使用環境</a></li><li><a href=#%e5%8f%82%e8%80%83 aria-label=参考>参考</a></li><li><a href=#%e3%82%bd%e3%83%bc%e3%82%b9%e3%82%b3%e3%83%bc%e3%83%89 aria-label=ソースコード>ソースコード</a></li></ul></div></details></div><div class=post-content><h2 id=マイク>マイク<a hidden class=anchor aria-hidden=true href=#マイク>#</a></h2><ul><li>Google Pixel 4a</li></ul><h2 id=解析対象>解析対象<a hidden class=anchor aria-hidden=true href=#解析対象>#</a></h2><ul><li>バイク<ul><li>125cc</li><li>単気筒</li><li>4ストローク</li><li>NA</li></ul></li><li>F1<ul><li>2.4L</li><li>V8</li><li>4ストローク</li><li>NA</li></ul></li><li>ブルーインパルス<ul><li>ターボファン・エンジン</li></ul></li></ul><h2 id=バイク>バイク<a hidden class=anchor aria-hidden=true href=#バイク>#</a></h2><ul><li>1100rpm
<img loading=lazy src=Motorcycle-1100rpm-idling.png alt=Motorcycle-1100rpm-idling><br><br></li></ul><p><img loading=lazy src=Motorcycle-1100rpm-idling-fft.png alt=Motorcycle-1100rpm-idling-fft><br><br><audio src=Motorcycle-1100rpm-idling.mp4 controls></audio><br><br></p><ul><li>5000rpm
<img loading=lazy src=Motorcycle-5000rpm.png alt=Motorcycle-5000rpm><br><br></li></ul><p><img loading=lazy src=Motorcycle-5000rpm-fft.png alt=Motorcycle-5000rpm-fft><br><br><audio src=Motorcycle-5000rpm.mp4 controls></audio><br><br></p><ul><li>Revving
<img loading=lazy src=Motorcycle-rev.png alt=Motorcycle-rev><br><br><audio src=Motorcycle-rev.mp4 controls></audio><br><br></li></ul><h2 id=f1>F1<a hidden class=anchor aria-hidden=true href=#f1>#</a></h2><p><img loading=lazy src=F1.png alt=F1><br><br><audio src=F1.mp3 controls></audio><br><br></p><h2 id=ブルーインパルス>ブルーインパルス<a hidden class=anchor aria-hidden=true href=#ブルーインパルス>#</a></h2><p><img loading=lazy src=BlueImpulse.png alt=BlueImpulse><br><br><audio src=BlueImpulse.mp3 controls></audio><br><br></p><h2 id=使用環境>使用環境<a hidden class=anchor aria-hidden=true href=#使用環境>#</a></h2><ul><li>MATLAB R2020a</li><li>Signal Processing Toolbox</li></ul><h2 id=参考>参考<a hidden class=anchor aria-hidden=true href=#参考>#</a></h2><ul><li><a href=https://jp.mathworks.com/help/matlab/audio-and-video.html>MathWorks - オーディオとビデオ</a></li><li><a href=https://jp.mathworks.com/help/signal/ref/spectrogram.html>MathWorks - spectrogram</a></li><li><a href=https://ja.wikipedia.org/wiki/%E7%9F%AD%E6%99%82%E9%96%93%E3%83%95%E3%83%BC%E3%83%AA%E3%82%A8%E5%A4%89%E6%8F%9B>Wikipedia - 短時間フーリエ変換</a></li><li><a href=https://www.jstage.jst.go.jp/article/itej/66/2/66_130/_article/-char/ja/>MATLABによる音声信号処理入門</a></li></ul><h2 id=ソースコード>ソースコード<a hidden class=anchor aria-hidden=true href=#ソースコード>#</a></h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-engine_sound_analysis.m data-lang=engine_sound_analysis.m>clear all;
close all;
clc;

<span style=color:#75715e>% ファイル名</span>
filename = <span style=color:#e6db74>&#39;filename&#39;</span>;

<span style=color:#75715e>% オーディオファイルに関する情報取得</span>
info = audioinfo(filename)

<span style=color:#75715e>% オーディオファイル読み込み（5秒分だけ）</span>
samples = [<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>5</span><span style=color:#f92672>*</span>info.SampleRate];
[y,Fs] = audioread(filename,samples,<span style=color:#e6db74>&#39;double&#39;</span>);

<span style=color:#75715e>% ステレオ→モノラル</span>
<span style=color:#66d9ef>if</span> size(y,<span style=color:#ae81ff>2</span>)
    yMono = sum(y,<span style=color:#ae81ff>2</span>) <span style=color:#f92672>/</span> size(y,<span style=color:#ae81ff>2</span>);
    y = yMono;
<span style=color:#66d9ef>end</span>

<span style=color:#75715e>% 振幅グラフ</span>
subplot(<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>1</span>);
plot(<span style=color:#ae81ff>0</span>:<span style=color:#ae81ff>1</span><span style=color:#f92672>/</span>Fs:(length(y)<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>/</span>Fs,y);
xlabel(<span style=color:#e6db74>&#39;Time (seconds)&#39;</span>);
ylabel(<span style=color:#e6db74>&#39;Amplitude&#39;</span>);
ylim([<span style=color:#f92672>-</span><span style=color:#ae81ff>1.5</span> <span style=color:#ae81ff>1.5</span>]);

<span style=color:#75715e>% スペクトログラム</span>
Nw = <span style=color:#ae81ff>4096</span>;    <span style=color:#75715e>% フレーム長</span>
No = <span style=color:#ae81ff>1024</span>;    <span style=color:#75715e>% フレームシフト長（オーバーラップ1/4）</span>

subplot(<span style=color:#ae81ff>2</span>,<span style=color:#ae81ff>1</span>,<span style=color:#ae81ff>2</span>);
spectrogram(y,Nw,No,Nw,Fs,<span style=color:#e6db74>&#39;yaxis&#39;</span>);
ax = gca;
ax.YScale = <span style=color:#e6db74>&#39;log&#39;</span>;                <span style=color:#75715e>% 対数表示</span>
xlabel(<span style=color:#e6db74>&#39;Time (seconds)&#39;</span>);
ylabel(<span style=color:#e6db74>&#39;Frequency (kHz)&#39;</span>);

<span style=color:#75715e>% カラーバー位置変更</span>
colorbar(<span style=color:#e6db74>&#39;off&#39;</span>);
c = colorbar(<span style=color:#e6db74>&#39;east&#39;</span>);
c.Label.String = <span style=color:#e6db74>&#39;Power/frequency (dB/Hz)&#39;</span>;

<span style=color:#75715e>% サブプロットのタイトル</span>
sgt = sgtitle(filename,<span style=color:#e6db74>&#39;Color&#39;</span>,<span style=color:#e6db74>&#39;red&#39;</span>);
sgt.FontSize = <span style=color:#ae81ff>16</span>;

<span style=color:#75715e>% グラフを保存</span>
[filepath,name,ext] = fileparts(filename);
saveas(gcf,strcat(name,<span style=color:#e6db74>&#39;.png&#39;</span>));

<span style=color:#75715e>% オーディオファイル再生</span>
playerObj = audioplayer(y,Fs);
play(playerObj);
</code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://xxkizashi.github.io/blank-space/tags/matlab/simulink/>MATLAB/Simulink</a></li><li><a href=https://xxkizashi.github.io/blank-space/tags/motorcycle/>Motorcycle</a></li></ul><nav class=paginav><a class=prev href=https://xxkizashi.github.io/blank-space/posts/2021-10-27-fsae-slack/><span class=title>«</span><br><span>学生フォーミュラチームへのSlack導入</span></a>
<a class=next href=https://xxkizashi.github.io/blank-space/posts/2021-08-31-motorcycle-helmet-lock/><span class=title>»</span><br><span>ヘルメットロック取付け</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=https://xxkizashi.github.io/blank-space/>BlankSpace</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><script>let menu=document.getElementById('menu')
if(menu){menu.scrollLeft=localStorage.getItem("menu-scroll-position");menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft);}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.pushState(null,null,`#${id}`);}});});</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script></body></html>